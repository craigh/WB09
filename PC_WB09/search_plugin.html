{pnpageaddvar name="stylesheet" value="modules/PostCalendar/pntemplates/default/style/style.css"}

<!-- main navigation -->

{ *We should have results and should display them* }
{ counter start=0 print=false assign="eventCount" }
{ pc_sort_events var="S_EVENTS" sort="category" order="asc" value=$A_EVENTS }
{ foreach name=dates item=date key=cdate from=$S_EVENTS }
	{ if $date|@count > 0 }
	{ assign var="dayname" value=$cdate|date_format:"%w" }
    { assign var="day" value=$cdate|date_format:"%d"|string_format:"%1d" }
    { assign var="month" value=$cdate|date_format:"%m"|string_format:"%1d" }
	{ assign var="month" value=$month-1 }
    { assign var="year" value=$cdate|date_format:"%Y"|string_format:"%4d" }
	<table width="100%" border="0" cellpadding="5" cellspacing="0" class="dayheader">
		<tr>
			<td width="100%">
    			<a href="{ pc_url action=day date=$cdate }">
			{ if $USE_INT_DATES eq true }
				{ pc_date_format date=$cdate format="%A, %d %B %Y" }
			{ else }	
				{ pc_date_format date=$cdate format="%A, %B %d %Y" }
			{ /if }</a>
    		</td>
		</tr>
	</table>
	<table width="100%" border="0" cellpadding="5" cellspacing="0" class="calcontainer">
		<tr>
			<td width="100%" class="eventslist">
    			{ assign var="oldCat" value="" }
				{ foreach name=events item=event from=$date }
					{ counter }
					{ assign var="cCat" value=$event.catname }
					{ if $oldCat != $cCat }
					{ if $smarty.foreach.events.first != true }
						</div>
					{ /if }
					<div width="100%" style="padding: 2px; background-color: { $event.catcolor };">
						{ $event.catname }
					</div>
					<div width="100%" style="padding: 2px; border:solid 1px { $event.catcolor };">
					{ /if }
					{ if $24HOUR_TIME }
						{ assign var="timestamp" value=$event.startTime|date_format:"%H:%M" }
					{ else }
						{ assign var="timestamp" value=$event.startTime|date_format:"%I:%M %p" }
					{ /if }
					{ if $event.alldayevent != true }
						{ $timestamp }  
					{ /if }
					<a href="{ pc_url action=detail eid=$event.eid date=$cdate }" 
					{ pc_popup delay="500" 
	            			   bgcolor=$event.catcolor 
			    			   caption=$event.title 
			    			   text=$event.hometext }>
    				{ $event.title|strip_tags }</a> 
					{ if $event.alldayevent != true }
						({ $event.duration_hours }:{ $event.duration_minutes })
					{ /if }
					<br />
					{ assign var="oldCat" value=$event.catname }
					{ if $smarty.foreach.events.last }
						{ * we need to close out the <div> tag * }
						</div>
					{ /if }
				{ /foreach }
    		</td>
		</tr>
	</table>
	{ /if }
{ /foreach }
{ if $eventCount == 0 }
PostCalendar: NO RESULTS<br />
{ /if }
<br />